<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>7777 Refferal - Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* --- CSS RESET & STYLE UTAMA --- */
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            font-family: 'Poppins', sans-serif; 
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        :root {
            /* LIGHT THEME COLORS */
            --bg-color: #f8fafc;       
            --card-bg: #ffffff;        
            --linkedin-blue: #0a66c2;  
            --linkedin-dark: #004182;
            --linkedin-light: #e8f4f9;
            --whatsapp-green: #25d366; 
            --whatsapp-dark: #1da851;
            --gold-reward: #f59e0b;    
            --bonus-color: #8b5cf6;    
            --danger-red: #ef4444;     
            --dark-red: #b91c1c;       
            --warning-orange: #f59e0b; 
            --success-green: #10b981;
            --text-dark: #1f2937;
            --text-gray: #6b7280;
            --text-light: #4b5563;
            --radius: 12px;
            --grid-color: rgba(10, 102, 194, 0.05);
            --shadow-color: rgba(0, 0, 0, 0.05);
            --border-color: #e5e7eb;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-dark);
            display: flex;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
            will-change: transform;
            contain: layout style;
            transition: background-color 0.3s ease;
        }

        /* --- ANIMATED 3D GRID BACKGROUND (Optimized for Light) --- */
        .animated-grid-bg {
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100vw; 
            height: 100vh;
            z-index: -1; 
            perspective: 1000px; 
            overflow: hidden;
            pointer-events: none;
            transform: translateZ(0);
            opacity: 0.4;
        }
        .grid-plane {
            position: absolute; 
            top: -50%; 
            left: -50%; 
            width: 200%; 
            height: 200%;
            transform-style: preserve-3d; 
            transform: rotateX(70deg);
            background-image: 
                repeating-linear-gradient(0deg, var(--grid-color) 0px, var(--grid-color) 1px, transparent 1px, transparent 50px),
                repeating-linear-gradient(90deg, var(--grid-color) 0px, var(--grid-color) 1px, transparent 1px, transparent 50px);
            background-size: 50px 50px; 
            animation: gridMove 40s linear infinite;
            will-change: background-position;
            backface-visibility: hidden;
        }
        @keyframes gridMove { 
            from { background-position: 0 0; } 
            to { background-position: 0 100px; } 
        }

        .container { 
            width: 100%; 
            max-width: 600px; 
            padding-bottom: 80px; 
            position: relative; 
            z-index: 1;
            contain: layout style;
        }

        /* HEADER */
        header {
            display: flex; 
            justify-content: space-between; 
            align-items: flex-start;
            margin-bottom: 20px; 
            padding: 0 5px; 
            gap: 15px;
            transform: translateZ(0);
            transition: transform 0.2s ease;
        }
        
        .header-info h1 { 
            font-size: 1.6rem; 
            color: var(--linkedin-blue); 
            font-weight: 700; 
            margin-bottom: 5px; 
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
            transform: translateZ(0);
        }
        .header-info p { 
            font-size: 0.9rem; 
            color: var(--text-gray); 
            line-height: 1.4; 
            max-width: 90%; 
            transform: translateZ(0);
        }
        .header-actions { 
            display: flex; 
            gap: 10px; 
            transform: translateZ(0);
        }

        .btn-icon {
            width: 40px; 
            height: 40px; 
            border-radius: 50%; 
            background: white;
            border: 1px solid var(--border-color); 
            color: var(--linkedin-blue);
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            justify-content: center;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); 
            flex-shrink: 0;
            transform: translateZ(0);
            box-shadow: 0 2px 8px var(--shadow-color);
        }
        .btn-icon:hover { 
            background: var(--linkedin-blue); 
            color: white; 
            border-color: var(--linkedin-blue); 
            transform: translateY(-2px) translateZ(0) scale(1.05);
            box-shadow: 0 4px 12px rgba(10, 102, 194, 0.15);
        }

        /* BUTTONS */
        .header-buttons { 
            display: flex; 
            gap: 10px; 
            flex-wrap: wrap; 
            margin-top: 12px; 
            transform: translateZ(0);
        }

        .btn-reward, .btn-join, .btn-calc {
            font-size: 0.85rem; 
            font-weight: 600; 
            padding: 8px 16px; 
            border-radius: 30px; 
            cursor: pointer; 
            display: inline-flex; 
            align-items: center; 
            gap: 6px; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            text-decoration: none; 
            border: none;
            transform: translateZ(0);
            will-change: transform, background-color;
            box-shadow: 0 2px 8px var(--shadow-color);
        }
        .btn-reward { 
            color: white; 
            background: var(--linkedin-blue); 
        }
        .btn-reward:hover { 
            background: var(--linkedin-dark); 
            transform: translateY(-2px) translateZ(0) scale(1.05); 
            box-shadow: 0 6px 15px rgba(10, 102, 194, 0.2);
        }
        .btn-join { 
            color: var(--linkedin-blue); 
            background: white; 
            border: 2px solid var(--linkedin-blue); 
        }
        .btn-join:hover { 
            background: var(--linkedin-blue); 
            color: white; 
            transform: translateY(-2px) translateZ(0) scale(1.05);
            box-shadow: 0 6px 15px rgba(10, 102, 194, 0.15);
        }
        .btn-calc { 
            color: #fff; 
            background: var(--warning-orange); 
        }
        .btn-calc:hover { 
            background: #d97706; 
            transform: translateY(-2px) translateZ(0) scale(1.05); 
            box-shadow: 0 6px 15px rgba(245, 158, 11, 0.2);
        }
        svg { 
            width: 16px; 
            height: 16px; 
            transform: translateZ(0);
        }

        /* SEARCH BAR */
        .search-container { 
            margin-bottom: 20px; 
            position: relative; 
            transform: translateZ(0);
            transition: transform 0.2s ease;
        }
        .search-input {
            width: 100%; 
            padding: 15px 15px 15px 45px; 
            border: 1px solid var(--border-color);
            border-radius: var(--radius); 
            font-size: 1rem; 
            outline: none;
            box-shadow: 0 2px 8px var(--shadow-color); 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateZ(0);
            background: white;
            color: var(--text-dark);
        }
        .search-input:focus { 
            border-color: var(--linkedin-blue); 
            box-shadow: 0 4px 12px rgba(10, 102, 194, 0.1), 0 0 0 3px rgba(10, 102, 194, 0.05); 
        }
        .search-input::placeholder {
            color: var(--text-gray);
        }
        .search-icon-overlay { 
            position: absolute; 
            left: 15px; 
            top: 50%; 
            transform: translateY(-50%) translateZ(0); 
            color: var(--text-gray); 
            pointer-events: none;
        }

        /* FAB BUTTON */
        .fab-container { 
            position: fixed; 
            bottom: 30px; 
            right: 30px; 
            z-index: 900; 
            transform: translateZ(0);
        }
        .fab-btn {
            width: 60px; 
            height: 60px; 
            border-radius: 50%;
            background-color: var(--whatsapp-green); 
            color: white;
            border: none; 
            box-shadow: 0 4px 15px rgba(37, 211, 102, 0.3);
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            justify-content: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateZ(0);
            will-change: transform;
            animation: gentlePulse 3s infinite ease-in-out;
        }
        .fab-btn:hover { 
            transform: scale(1.15) translateZ(0); 
            background-color: var(--whatsapp-dark); 
            box-shadow: 0 8px 25px rgba(37, 211, 102, 0.4);
        }
        .fab-btn svg { 
            width: 30px; 
            height: 30px; 
        }

        @keyframes gentlePulse {
            0%, 100% { 
                box-shadow: 0 4px 15px rgba(37, 211, 102, 0.3);
            }
            50% { 
                box-shadow: 0 6px 20px rgba(37, 211, 102, 0.4);
            }
        }

        /* --- CARD GROUP STYLE --- */
        .group-container { 
            display: flex; 
            flex-direction: column; 
            gap: 16px; 
            transform: translateZ(0);
        }
        .referral-card { 
            background: var(--card-bg); 
            border-radius: var(--radius); 
            box-shadow: 0 4px 12px var(--shadow-color); 
            overflow: hidden; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            border: 1px solid var(--border-color);
            transform: translateZ(0);
            will-change: transform;
            backface-visibility: hidden;
            opacity: 0;
            animation: fadeInUp 0.5s forwards;
        }
        
        .referral-card:nth-child(1) { animation-delay: 0.1s; }
        .referral-card:nth-child(2) { animation-delay: 0.2s; }
        .referral-card:nth-child(3) { animation-delay: 0.3s; }
        .referral-card:nth-child(4) { animation-delay: 0.4s; }
        .referral-card:nth-child(5) { animation-delay: 0.5s; }
        .referral-card:nth-child(n+6) { animation-delay: 0.6s; }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .referral-card:hover {
            transform: translateY(-8px) translateZ(0) scale(1.02);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.08);
            border-color: var(--linkedin-blue);
        }

        /* CARD CONTENT */
        .card-header { 
            padding: 15px 20px; 
            background: #f8fafc; 
            border-bottom: 1px solid var(--border-color); 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            transform: translateZ(0);
        }
        .code-title { 
            font-size: 1.1rem; 
            font-weight: 700; 
            color: var(--linkedin-blue); 
            letter-spacing: 0.5px; 
            transform: translateZ(0);
        }
        .reward-badge { 
            background: var(--whatsapp-green); 
            color: white; 
            padding: 5px 12px; 
            border-radius: 20px; 
            font-weight: 600; 
            font-size: 0.9rem; 
            transform: translateZ(0);
            box-shadow: 0 2px 8px rgba(37, 211, 102, 0.2);
        }
        .reward-badge.high-tier { 
            background: var(--bonus-color); 
            box-shadow: 0 2px 8px rgba(139, 92, 246, 0.2);
        }
        .card-stats { 
            padding: 12px 20px; 
            display: flex; 
            justify-content: space-between; 
            font-size: 0.85rem; 
            color: var(--text-gray); 
            border-bottom: 1px solid var(--border-color); 
            transform: translateZ(0);
        }
        .stat-item strong { 
            color: var(--text-dark); 
        }

        /* EMAIL LIST & ADMIN */
        .email-list { 
            list-style: none; 
            padding: 0; 
            max-height: 200px; 
            overflow-y: auto; 
            transform: translateZ(0);
            scrollbar-width: thin;
            scrollbar-color: var(--linkedin-blue) transparent;
        }
        .email-list::-webkit-scrollbar {
            width: 6px;
        }
        .email-list::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .email-list::-webkit-scrollbar-thumb {
            background: var(--linkedin-blue);
            border-radius: 10px;
        }
        .email-list::-webkit-scrollbar-thumb:hover {
            background: var(--linkedin-dark);
        }
        .email-item { 
            padding: 10px 20px; 
            font-size: 0.9rem; 
            border-bottom: 1px solid var(--border-color); 
            display: flex; 
            align-items: center; 
            gap: 10px; 
            transform: translateZ(0);
            transition: background-color 0.2s ease;
        }
        .email-item:hover {
            background-color: rgba(10, 102, 194, 0.03);
        }
        .email-item:last-child { 
            border-bottom: none; 
        }
        .email-item::before { 
            content: ""; 
            width: 6px; 
            height: 6px; 
            background: var(--linkedin-blue); 
            border-radius: 50%; 
        }
        
        .admin-wrapper { 
            background: var(--card-bg); 
            padding: 25px; 
            border-radius: var(--radius); 
            box-shadow: 0 4px 12px var(--shadow-color); 
            margin-bottom: 20px; 
            transform: translateZ(0);
            border: 1px solid var(--border-color);
        }
        .form-group { 
            margin-bottom: 15px; 
            transform: translateZ(0);
        }
        .form-group label { 
            display: block; 
            margin-bottom: 8px; 
            font-size: 0.9rem; 
            color: var(--text-gray); 
            transform: translateZ(0);
        }
        .form-group input, .form-group textarea { 
            width: 100%; 
            padding: 12px; 
            border: 1px solid var(--border-color); 
            border-radius: 8px; 
            outline: none; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateZ(0);
            background: white;
            color: var(--text-dark);
        }
        .form-group input:focus, .form-group textarea:focus { 
            border-color: var(--linkedin-blue); 
            box-shadow: 0 0 0 3px rgba(10, 102, 194, 0.1); 
        }
        .form-group input::placeholder, .form-group textarea::placeholder {
            color: var(--text-gray);
        }
        .btn-submit { 
            flex: 1; 
            padding: 12px; 
            background: var(--linkedin-blue); 
            color: white; 
            border: none; 
            border-radius: 8px; 
            font-weight: 600; 
            cursor: pointer; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateZ(0);
            box-shadow: 0 2px 8px rgba(10, 102, 194, 0.2);
        }
        .btn-submit:hover { 
            background: var(--linkedin-dark); 
            transform: translateY(-2px) translateZ(0) scale(1.05); 
            box-shadow: 0 4px 12px rgba(10, 102, 194, 0.25);
        }
        .btn-cancel { 
            flex: 1; 
            padding: 12px; 
            background: #f3f4f6; 
            color: var(--text-dark); 
            border: none; 
            border-radius: 8px; 
            font-weight: 600; 
            cursor: pointer; 
            margin-left: 10px; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateZ(0);
        }
        .btn-cancel:hover { 
            background: #e5e7eb; 
            transform: translateY(-2px) translateZ(0) scale(1.05); 
        }
        
        .admin-list-container { 
            background: var(--card-bg); 
            border-radius: var(--radius); 
            padding: 20px; 
            box-shadow: 0 4px 12px var(--shadow-color); 
            transform: translateZ(0);
            border: 1px solid var(--border-color);
        }
        
        /* Updated Admin Header with Delete All */
        .admin-list-header { 
            font-weight: 700; 
            color: var(--linkedin-blue); 
            margin-bottom: 15px; 
            border-bottom: 1px solid var(--border-color); 
            padding-bottom: 10px;
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            transform: translateZ(0);
        }
        .btn-delete-all {
            background-color: var(--dark-red); 
            color: white; 
            border: none; 
            padding: 6px 12px; 
            border-radius: 6px; 
            font-size: 0.75rem; 
            font-weight: 600; 
            cursor: pointer; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateZ(0);
            box-shadow: 0 2px 6px rgba(185, 28, 28, 0.2);
        }
        .btn-delete-all:hover { 
            background-color: #991b1b; 
            transform: translateY(-2px) translateZ(0) scale(1.05); 
            box-shadow: 0 4px 10px rgba(185, 28, 28, 0.3);
        }

        .admin-item { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding: 12px; 
            border-bottom: 1px solid var(--border-color); 
            transform: translateZ(0);
            transition: all 0.2s ease;
        }
        .admin-item:hover {
            background-color: rgba(10, 102, 194, 0.03);
            transform: translateX(4px);
        }
        .admin-item:last-child { 
            border-bottom: none; 
        }
        .admin-info { 
            flex: 1; 
            transform: translateZ(0);
        }
        .admin-info strong { 
            display: block; 
            font-size: 0.9rem; 
            color: var(--text-dark); 
            transform: translateZ(0);
        }
        .admin-info span { 
            font-size: 0.8rem; 
            color: var(--text-gray); 
            transform: translateZ(0);
        }
        .admin-actions { 
            display: flex; 
            gap: 8px; 
            transform: translateZ(0);
        }
        .btn-edit, .btn-delete { 
            padding: 6px 10px; 
            border-radius: 6px; 
            border: none; 
            cursor: pointer; 
            color: white; 
            font-size: 0.75rem; 
            font-weight: 600; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateZ(0);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }
        .btn-edit { 
            background: var(--warning-orange); 
        }
        .btn-edit:hover { 
            background: #d97706; 
            transform: translateY(-2px) translateZ(0) scale(1.1); 
        }
        .btn-delete { 
            background: var(--danger-red); 
        }
        .btn-delete:hover { 
            background: #dc2626; 
            transform: translateY(-2px) translateZ(0) scale(1.1); 
        }

        /* BUTTON MASSA */
        .btn-mass {
            background: var(--success-green); 
            color: white; 
            border: none; 
            padding: 8px 16px; 
            border-radius: 6px;
            font-weight: 600; 
            cursor: pointer; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            display: flex; 
            align-items: center; 
            gap: 6px;
            margin-top: 10px; 
            font-size: 0.85rem;
            transform: translateZ(0);
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.2);
        }
        .btn-mass:hover { 
            background: #0da271; 
            transform: translateY(-2px) translateZ(0) scale(1.05); 
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        /* MODAL */
        .hidden { 
            display: none !important; 
        }
        .no-result { 
            text-align: center; 
            color: var(--text-gray); 
            font-style: italic; 
            margin-top: 20px; 
            display: none; 
            transform: translateZ(0);
        }
        .modal { 
            display: none; 
            position: fixed; 
            z-index: 1000; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%; 
            background-color: rgba(0,0,0,0.5); 
            align-items: center; 
            justify-content: center; 
            backdrop-filter: blur(4px); 
            padding: 20px; 
            opacity: 0;
            transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .modal.show {
            opacity: 1;
            display: flex;
        }
        .modal-content { 
            background: var(--card-bg); 
            width: 100%; 
            max-width: 500px; 
            border-radius: 16px; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.15); 
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            max-height: 90vh; 
            overflow-y: auto; 
            position: relative;
            transform: translateZ(0);
            backface-visibility: hidden;
            border: 1px solid var(--border-color);
        }
        @keyframes slideUp { 
            from { 
                opacity: 0; 
                transform: translateY(30px) scale(0.95); 
            } 
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            } 
        }
        .modal-header { 
            padding: 20px; 
            border-bottom: 1px solid var(--border-color); 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            position: sticky; 
            top: 0; 
            background: var(--card-bg); 
            z-index: 10; 
            transform: translateZ(0);
        }
        .modal-header h2 { 
            font-size: 1.2rem; 
            color: var(--linkedin-blue); 
            transform: translateZ(0);
        }
        .close-modal { 
            font-size: 1.5rem; 
            cursor: pointer; 
            color: var(--text-gray); 
            transition: all 0.2s ease;
            transform: translateZ(0);
        }
        .close-modal:hover { 
            color: var(--text-dark); 
            transform: scale(1.1);
        }
        .modal-body { 
            padding: 20px; 
            transform: translateZ(0);
        }
        .styled-table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-bottom: 20px; 
            font-size: 0.9rem; 
            transform: translateZ(0);
        }
        .styled-table thead { 
            background-color: var(--linkedin-light); 
            color: var(--linkedin-blue); 
        }
        .styled-table th, .styled-table td { 
            padding: 12px 15px; 
            border: 1px solid var(--border-color); 
            transform: translateZ(0);
            color: var(--text-dark);
        }
        .styled-table .cell-icon { 
            display: flex; 
            align-items: center; 
            gap: 8px; 
            transform: translateZ(0);
        }
        .price-text { 
            color: var(--whatsapp-green); 
            font-weight: 700; 
            transform: translateZ(0);
        }
        .bonus-text {
            color: var(--bonus-color);
            font-weight: 700;
            font-size: 0.85rem;
        }
        .highlight-box { 
            background: #f0fdf4; 
            border: 1px solid #bbf7d0; 
            color: #166534; 
            padding: 12px; 
            border-radius: 8px; 
            margin-bottom: 20px; 
            font-size: 0.9rem; 
            transform: translateZ(0);
        }
        .rules-list { 
            padding-left: 20px; 
            margin-bottom: 20px; 
            transform: translateZ(0);
        }
        .rules-list li { 
            margin-bottom: 10px; 
            font-size: 0.85rem; 
            color: var(--text-dark); 
            line-height: 1.5; 
            transform: translateZ(0);
        }
        .special-rules { 
            background: #fffbeb; 
            border: 1px solid #fcd34d; 
            border-radius: 8px; 
            padding: 15px; 
            transform: translateZ(0);
        }
        .special-rules h3 { 
            font-size: 0.9rem; 
            color: #92400e; 
            margin-bottom: 8px; 
            transform: translateZ(0);
        }
        .special-rules p { 
            font-size: 0.85rem; 
            color: #b45309; 
            line-height: 1.4; 
            transform: translateZ(0);
        }
        .btn-wa-submit { 
            width: 100%; 
            padding: 14px; 
            background: var(--whatsapp-green); 
            color: white; 
            border: none; 
            border-radius: 8px; 
            font-weight: 600; 
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: 8px; 
            font-size: 1rem; 
            margin-top: 10px; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateZ(0);
            box-shadow: 0 2px 8px rgba(37, 211, 102, 0.2);
        }
        .btn-wa-submit:hover { 
            background: var(--whatsapp-dark); 
            transform: translateY(-2px) translateZ(0) scale(1.02); 
            box-shadow: 0 4px 12px rgba(37, 211, 102, 0.3);
        }
        .btn-wa-submit:disabled { 
            background: #9ca3af; 
            cursor: not-allowed; 
            transform: none;
            box-shadow: none;
        }
        .calc-result-box { 
            background: #f8fafc; 
            border: 2px solid var(--border-color); 
            border-radius: 12px; 
            padding: 20px; 
            text-align: center; 
            margin-top: 15px; 
            transform: translateZ(0);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .calc-result-box.active { 
            border-color: var(--bonus-color); 
            background: #f5f3ff; 
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.1);
        }
        .calc-label { 
            font-size: 0.85rem; 
            color: var(--text-gray); 
            display: block; 
            margin-bottom: 5px; 
            transform: translateZ(0);
        }
        .calc-main { 
            font-size: 2rem; 
            font-weight: 700; 
            color: var(--linkedin-blue); 
            display: block; 
            transform: translateZ(0);
        }
        .calc-sub { 
            font-size: 1.2rem; 
            color: var(--whatsapp-green); 
            font-weight: 600; 
            transform: translateZ(0);
        }
        .rate-badge-calc { 
            display: inline-block; 
            padding: 4px 10px; 
            border-radius: 20px; 
            font-size: 0.75rem; 
            background: #f3f4f6; 
            color: var(--text-gray); 
            margin-top: 10px; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateZ(0);
        }
        .rate-badge-calc.active { 
            background: var(--bonus-color); 
            color: white; 
            transform: scale(1.05) translateZ(0);
            box-shadow: 0 2px 8px rgba(139, 92, 246, 0.2);
        }

        /* STYLE UNTUK EMAIL MASSA */
        .email-mass-preview { 
            max-height: 300px; 
            overflow-y: auto; 
            margin: 15px 0; 
            padding: 15px; 
            border: 1px solid var(--border-color); 
            border-radius: 8px; 
            background: #f9fafb; 
            transform: translateZ(0);
        }
        .email-mass-preview::-webkit-scrollbar {
            width: 6px;
        }
        .email-mass-preview::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .email-mass-preview::-webkit-scrollbar-thumb {
            background: var(--linkedin-blue);
            border-radius: 10px;
        }
        .email-mass-preview::-webkit-scrollbar-thumb:hover {
            background: var(--linkedin-dark);
        }
        .email-preview-item { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding: 8px 12px; 
            margin-bottom: 5px; 
            background: white; 
            border-radius: 6px; 
            border: 1px solid var(--border-color); 
            transition: all 0.2s ease;
            transform: translateZ(0);
        }
        .email-preview-item:hover {
            transform: translateX(4px) translateZ(0);
            border-color: var(--linkedin-blue);
        }
        .email-preview-item:last-child { 
            margin-bottom: 0; 
        }
        .email-preview-item.duplicate { 
            background: #fef2f2; 
            border-color: #fecaca; 
        }
        .email-preview-item.new { 
            background: #f0fdf4; 
            border-color: #bbf7d0; 
        }
        .email-preview-actions { 
            display: flex; 
            gap: 8px; 
            transform: translateZ(0);
        }
        .email-preview-badge { 
            font-size: 0.7rem; 
            padding: 2px 6px; 
            border-radius: 10px; 
            font-weight: 600; 
            transform: translateZ(0);
        }
        .badge-duplicate { 
            background: #fee2e2; 
            color: #991b1b; 
        }
        .badge-new { 
            background: #dcfce7; 
            color: #166534; 
        }
        .btn-remove-email { 
            background: var(--danger-red); 
            color: white; 
            border: none; 
            width: 24px; 
            height: 24px; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            cursor: pointer; 
            font-size: 0.8rem; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateZ(0);
            box-shadow: 0 2px 6px rgba(239, 68, 68, 0.2);
        }
        .btn-remove-email:hover { 
            background: #dc2626; 
            transform: scale(1.1) translateZ(0); 
            box-shadow: 0 4px 10px rgba(239, 68, 68, 0.3);
        }
        .btn-remove-all { 
            background: var(--dark-red); 
            color: white; 
            border: none; 
            padding: 8px 12px; 
            border-radius: 6px; 
            font-size: 0.75rem; 
            font-weight: 600; 
            cursor: pointer; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            margin-left: auto; 
            transform: translateZ(0);
            box-shadow: 0 2px 6px rgba(185, 28, 28, 0.2);
        }
        .btn-remove-all:hover { 
            background-color: #991b1b; 
            transform: translateY(-2px) translateZ(0) scale(1.05); 
            box-shadow: 0 4px 10px rgba(185, 28, 28, 0.3);
        }
        .mass-results { 
            display: flex; 
            justify-content: space-between; 
            margin-top: 15px; 
            padding: 10px; 
            background: #f0f9ff; 
            border-radius: 8px; 
            border: 1px solid #bae6fd; 
            transform: translateZ(0);
        }
        .mass-results-item { 
            text-align: center; 
            transform: translateZ(0);
        }
        .mass-results-count { 
            font-size: 1.5rem; 
            font-weight: 700; 
            display: block; 
            transform: translateZ(0);
        }
        .mass-results-label { 
            font-size: 0.75rem; 
            color: var(--text-gray); 
            transform: translateZ(0);
        }
        .count-new { 
            color: var(--success-green); 
        }
        .count-duplicate { 
            color: var(--danger-red); 
        }
        .count-total { 
            color: var(--linkedin-blue); 
        }
        .info-text { 
            font-size: 0.8rem; 
            color: var(--text-gray); 
            margin-top: 10px; 
            font-style: italic; 
            transform: translateZ(0);
        }

        /* Loading Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .group-container > * {
            animation: fadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        /* Smooth scroll behavior */
        html {
            scroll-behavior: smooth;
        }

        /* Optimized transitions */
        * {
            -webkit-tap-highlight-color: transparent;
        }

        /* Page load animation */
        @keyframes pageLoad {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .container {
            animation: pageLoad 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

    </style>
</head>
<body>

    <div class="animated-grid-bg">
        <div class="grid-plane"></div>
    </div>

    <div class="container">
        
        <div id="viewDashboard">
            <header>
                <div class="header-info">
                    <h1>7777 Refferal</h1>
                    <p>Invite teman untuk disewakan di agent Fads dan dapatkan Bonus 48rb / invite + Bonus Tambahan</p>
                    
                    <div class="header-buttons">
                        <button class="btn-reward" onclick="openModal('rewardModal')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                            Detail
                        </button>
                        <button class="btn-join" onclick="openModal('joinModal')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><line x1="20" y1="8" x2="20" y2="14"></line><line x1="23" y1="11" x2="17" y2="11"></line></svg>
                            Gabung
                        </button>
                        <button class="btn-calc" onclick="openModal('calcModal')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="2" width="16" height="20" rx="2" ry="2"></rect><line x1="8" y1="6" x2="16" y2="6"></line><line x1="16" y1="14" x2="16" y2="14"></line><line x1="8" y1="14" x2="8" y2="14"></line><line x1="12" y1="14" x2="12" y2="14"></line><line x1="16" y1="18" x2="16" y2="18"></line><line x1="8" y1="18" x2="8" y2="18"></line><line x1="12" y1="18" x2="12" y2="18"></line></svg>
                            Hitung Cuan
                        </button>
                    </div>
                </div>
                
                <div class="header-actions">
                    <button class="btn-icon" onclick="switchView('admin')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"></path></svg>
                    </button>
                </div>
            </header>

            <div class="search-container">
                <svg class="search-icon-overlay" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                <input type="text" id="searchInput" class="search-input" placeholder="Cari kode refferal..." onkeyup="filterReferral()">
            </div>

            <div id="groupContainer" class="group-container">
                <div style="text-align:center; color:#999;">Memuat data...</div>
            </div>
            <div id="noResult" class="no-result">Data tidak ditemukan.</div>
        </div>

        <div class="fab-container">
            <button class="fab-btn" onclick="openModal('waModal')" title="Lapor Refferal Baru">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
            </button>
        </div>

        <div id="viewAdmin" class="hidden">
            <header>
                <div class="header-info">
                    <h1>Kelola Data</h1>
                    <p>Input, Edit, atau Hapus data referral</p>
                </div>
                <button class="btn-icon" onclick="switchView('dashboard')">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                </button>
            </header>

            <div class="admin-wrapper">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 id="formTitle" style="color:var(--linkedin-blue); margin: 0; font-size:1rem;">Tambah Data Baru</h3>
                    <button type="button" class="btn-mass" onclick="openModal('massModal')">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><line x1="20" y1="8" x2="20" y2="14"></line><line x1="23" y1="11" x2="17" y2="11"></line></svg>
                        Tambah Massal
                    </button>
                </div>
                
                <form id="addForm">
                    <input type="hidden" id="editIndex" value="-1">
                    <div class="form-group">
                        <label>Kode Refferal</label>
                        <input type="text" id="inputCode" placeholder="Masukan kode reff..." required>
                    </div>
                    <div class="form-group">
                        <label>Email User</label>
                        <input type="email" id="inputEmail" placeholder="user@gmail.com" required>
                    </div>
                    <div style="display: flex;">
                        <button type="submit" id="submitBtn" class="btn-submit">Simpan</button>
                        <button type="button" id="cancelBtn" class="btn-cancel hidden" onclick="resetForm()">Batal</button>
                    </div>
                </form>
            </div>

            <div class="admin-list-container">
                <div class="admin-list-header">
                    <span>Daftar Data Tersimpan</span>
                    <button class="btn-delete-all" onclick="deleteAllData()">Hapus Semua</button>
                </div>
                <div id="adminDataList">
                    <div style="text-align:center; color:#999;">Sedang memuat list...</div>
                </div>
            </div>
        </div>

    </div>

    <!-- MODAL EMAIL MASSA -->
    <div id="massModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Tambah Email Massal</h2>
                <span class="close-modal" onclick="closeModal('massModal'); resetMassForm()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="massForm" onsubmit="processMassEmail(event)">
                    <div class="form-group">
                        <label>Kode Refferal</label>
                        <input type="text" id="massCode" placeholder="Masukan kode reff..." required>
                    </div>
                    <div class="form-group">
                        <label>Daftar Email (pisahkan dengan koma, spasi, atau baris baru)</label>
                        <textarea id="massEmails" rows="6" placeholder="contoh1@gmail.com, contoh2@gmail.com
contoh3@gmail.com
contoh4@gmail.com" required></textarea>
                        <p class="info-text">Sistem akan otomatis mendeteksi dan menghapus duplikat dengan data yang sudah ada</p>
                    </div>
                    <button type="submit" class="btn-submit" style="width: 100%;">Proses Email</button>
                </form>
                
                <div id="massResults" style="display: none;">
                    <div class="mass-results">
                        <div class="mass-results-item">
                            <span class="mass-results-count count-total" id="totalEmails">0</span>
                            <span class="mass-results-label">Total Email</span>
                        </div>
                        <div class="mass-results-item">
                            <span class="mass-results-count count-new" id="newEmails">0</span>
                            <span class="mass-results-label">Baru</span>
                        </div>
                        <div class="mass-results-item">
                            <span class="mass-results-count count-duplicate" id="duplicateEmails">0</span>
                            <span class="mass-results-label">Duplikat</span>
                        </div>
                    </div>
                    
                    <div class="email-mass-preview" id="emailPreview">
                        <!-- Email akan ditampilkan di sini -->
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; margin-top: 15px;">
                        <button type="button" class="btn-remove-all" onclick="removeAllProcessedEmails()">
                            Hapus Semua
                        </button>
                        <button type="button" class="btn-submit" onclick="saveMassEmails()" id="saveMassBtn">
                            Simpan Email Baru
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Reward dengan sistem baru (TANPA BONUS WEEKLY) -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Detail Reward - Sistem Baru</h2>
                <span class="close-modal" onclick="closeModal('rewardModal')">&times;</span>
            </div>
            <div class="modal-body">
                <table class="styled-table">
                    <thead><tr><th>Level Invite</th><th style="text-align: right;">Reward</th><th style="text-align: right;">Bonus</th></tr></thead>
                    <tbody>
                        <tr><td><div class="cell-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg><span>1 Orang</span></div></td><td style="text-align: right;"><span class="price-text">$3</span></td><td style="text-align: right;"><span class="bonus-text">-</span></td></tr>
                        <tr><td><div class="cell-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg><span>2 Orang</span></div></td><td style="text-align: right;"><span class="price-text">$6</span></td><td style="text-align: right;"><span class="bonus-text">+ $1★</span></td></tr>
                        <tr><td><div class="cell-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg><span>3 Orang</span></div></td><td style="text-align: right;"><span class="price-text">$9</span></td><td style="text-align: right;"><span class="bonus-text">-</span></td></tr>
                        <tr><td><div class="cell-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg><span>4 Orang</span></div></td><td style="text-align: right;"><span class="price-text">$12</span></td><td style="text-align: right;"><span class="bonus-text">-</span></td></tr>
                        <tr><td><div class="cell-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg><span>5 Orang</span></div></td><td style="text-align: right;"><span class="price-text">$15</span></td><td style="text-align: right;"><span class="bonus-text">+ $1★</span></td></tr>
                        <tr><td><div class="cell-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg><span>6 Orang</span></div></td><td style="text-align: right;"><span class="price-text">$18</span></td><td style="text-align: right;"><span class="bonus-text">-</span></td></tr>
                        <tr><td><div class="cell-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg><span>7 Orang</span></div></td><td style="text-align: right;"><span class="price-text">$21</span></td><td style="text-align: right;"><span class="bonus-text">-</span></td></tr>
                        <tr><td><div class="cell-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg><span>8 Orang</span></div></td><td style="text-align: right;"><span class="price-text">$24</span></td><td style="text-align: right;"><span class="bonus-text">+ $1★</span></td></tr>
                        <tr><td><div class="cell-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg><span>9 Orang</span></div></td><td style="text-align: right;"><span class="price-text">$27</span></td><td style="text-align: right;"><span class="bonus-text">-</span></td></tr>
                        <tr><td><div class="cell-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg><span>10 Orang</span></div></td><td style="text-align: right;"><span class="price-text">$30</span></td><td style="text-align: right;"><span class="bonus-text">+ $1</span></td></tr>
                    </tbody>
                </table>
                <div class="highlight-box">
                    <p style="display: flex; gap:10px; align-items:center;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#d97706" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.1.2-2.2.6-3.3.7 1.8 1.8 3 2.9 3.8z"></path></svg>
                        <span><strong>Rate tetap:</strong> $3 (48.000) per invite</span>
                    </p>
                </div>
                <h3 style="font-size:1rem; margin-bottom:10px; color: var(--text-dark);">Syarat & Ketentuan</h3>
                <ul class="rules-list">
                    <li><strong>Refferer harus sudah/sedang atau akan menyewakan akunya di grup utama.</strong></li>
                    <li><strong>Email utama tidak termasuk sebagai Refferal.</strong></li>
                    <li>Pengundang harus edukasi membernya tentang mekanisme sewa (jadwal, cara setor, kapan gajian, dll).</li>
                    <li>Penyewa wajib mengirim laporan succes rental ke admin Myth dan konfirmasi Kode Refferal.</li>
                    <li>Pengundang harus konfirmasi email yang diundang kepada admin berupa Screenshot percakapan.</li>
                </ul>
                <div class="special-rules">
                    <h3>👑 Special Rules</h3>
                    <p>Khusus untuk refferer yang undang lebih dari 5 akun. Bisa <strong>1 Payment</strong> (Kalian yang gaji member kalian sendiri untuk kesan trusted/testimoni).</p>
                </div>
            </div>
        </div>
    </div>

    <div id="waModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Lapor Referral Baru</h2>
                <span class="close-modal" onclick="closeModal('waModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form onsubmit="sendToWa(event)">
                    <div class="form-group">
                        <label>Email yang diundang</label>
                        <input type="email" id="waEmail" placeholder="contoh@gmail.com" required>
                    </div>
                    <div class="form-group">
                        <label>Kode Referral Anda</label>
                        <input type="text" id="waCode" placeholder="Masukan kode..." required>
                    </div>
                    <button type="submit" class="btn-wa-submit">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>
                        Kirim Laporan
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Form Gabung dengan Email Utama (bukan WhatsApp) -->
    <div id="joinModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Mendaftar jadi Refferer di 7777</h2>
                <span class="close-modal" onclick="closeModal('joinModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form onsubmit="sendJoinRequest(event)">
                    <div class="form-group">
                        <label>Buat Code Referral saya</label>
                        <input type="text" id="reqCode" placeholder="Contoh: AGEN-01" required>
                    </div>
                    <!-- Ubah dari Nomor WhatsApp menjadi Email Utama -->
                    <div class="form-group">
                        <label>Email Utama Anda</label>
                        <input type="email" id="reqEmail" placeholder="emailanda@gmail.com" required>
                    </div>
                    <div class="form-group">
                        <label>Target Invite (Estimasi)</label>
                        <input type="number" id="reqTarget" placeholder="Misal: 50" required>
                    </div>
                    <button type="submit" class="btn-wa-submit">Gabung Sekarang</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Kalkulator dengan sistem reward baru -->
    <div id="calcModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Kalkulator Cuan</h2>
                <span class="close-modal" onclick="closeModal('calcModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Berapa invite yang kamu targetkan?</label>
                    <input type="number" id="calcInput" placeholder="0" oninput="calculateRewardNew()" style="font-size:1.5rem; text-align:center;">
                </div>
                <div id="calcResultBox" class="calc-result-box">
                    <span class="calc-label">Total Estimasi Pendapatan:</span>
                    <span class="calc-main" id="totalIdr">Rp 0</span>
                    <span class="calc-sub" id="totalUsd">($0)</span>
                    <div style="margin-top: 10px;">
                        <span class="rate-badge-calc">Base: $3 (48.000) / invite</span>
                        <span class="rate-badge-calc" id="bonusBadge" style="margin-left: 5px; background: #8b5cf6; color: white; display: none;">Bonus: $0</span>
                    </div>
                </div>
                <p style="font-size:0.75rem; color:var(--text-gray); text-align:center; margin-top:10px;">*Estimasi berdasarkan kurs fix rate (1$ = 16.000 IDR)</p>
            </div>
        </div>
    </div>

    <script>
        const BIN_ID = '697c2a3543b1c97be9568808';
        const API_KEY = '$2a$10$f7WJxnzzafwOUYiK9u7x0ueQAZUMyWpjWooi1XP3nNzkMNrfe75XO';
        const BASE_URL = `https://api.jsonbin.io/v3/b/${BIN_ID}`;

        const viewDashboard = document.getElementById('viewDashboard');
        const viewAdmin = document.getElementById('viewAdmin');
        const groupContainer = document.getElementById('groupContainer');
        const adminDataList = document.getElementById('adminDataList');
        const noResult = document.getElementById('noResult');
        
        const addForm = document.getElementById('addForm');
        const inputCode = document.getElementById('inputCode');
        const inputEmail = document.getElementById('inputEmail');
        const submitBtn = document.getElementById('submitBtn');
        const cancelBtn = document.getElementById('cancelBtn');
        const editIndexInput = document.getElementById('editIndex');
        const formTitle = document.getElementById('formTitle');

        // Variabel untuk fitur email massal
        let processedEmails = [];
        let massEmailData = {};
        let globalUsers = [];
        let isProcessing = false;

        // Performance optimization
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        function throttle(func, limit) {
            let inThrottle;
            return function() {
                const args = arguments;
                const context = this;
                if (!inThrottle) {
                    func.apply(context, args);
                    inThrottle = true;
                    setTimeout(() => inThrottle = false, limit);
                }
            };
        }

        function switchView(target) {
            if (target === 'admin') {
                let sandi = prompt("Masukkan Sandi Admin:");
                if (sandi === "Sinozhaki68") {
                    viewDashboard.classList.add('hidden');
                    viewAdmin.classList.remove('hidden');
                    document.querySelector('.fab-container').style.display = 'none';
                    renderAdminList();
                } else { if (sandi !== null) alert("Sandi Salah!"); }
            } else {
                viewAdmin.classList.add('hidden');
                viewDashboard.classList.remove('hidden');
                document.querySelector('.fab-container').style.display = 'block';
                document.getElementById('searchInput').value = "";
                filterReferral(); 
                fetchData();
            }
        }

        function isEmailDuplicate(email, excludeIndex = -1) {
            return globalUsers.some((user, index) => {
                if (index === excludeIndex) return false;
                return user.email.toLowerCase().trim() === email.toLowerCase().trim();
            });
        }

        const filterReferral = debounce(function() {
            const input = document.getElementById('searchInput');
            const filter = input.value.toUpperCase();
            const cards = groupContainer.getElementsByClassName('referral-card');
            let visibleCount = 0;
            
            requestAnimationFrame(() => {
                for (let i = 0; i < cards.length; i++) {
                    const title = cards[i].getElementsByClassName('code-title')[0];
                    if (title) {
                        const txtValue = title.textContent || title.innerText;
                        if (txtValue.toUpperCase().indexOf(filter) > -1) {
                            cards[i].style.display = ""; 
                            visibleCount++;
                        } else { 
                            cards[i].style.display = "none"; 
                        }
                    }
                }
                if (visibleCount === 0 && cards.length > 0) {
                    noResult.style.display = "block";
                } else {
                    noResult.style.display = "none";
                }
            });
        }, 200);

        function openModal(modalId) { 
            const modal = document.getElementById(modalId);
            modal.classList.add('show');
            setTimeout(() => {
                modal.style.display = "flex";
            }, 10);
        }
        
        function closeModal(modalId) { 
            const modal = document.getElementById(modalId);
            modal.classList.remove('show');
            setTimeout(() => {
                modal.style.display = "none";
            }, 300);
        }
        
        window.onclick = function(event) { 
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('show');
                setTimeout(() => {
                    event.target.style.display = "none";
                }, 300);
            }
        }

        // Fungsi baru untuk menghitung reward dengan sistem bonus
        function calculateRewardNew() {
            const count = parseInt(document.getElementById('calcInput').value) || 0;
            const box = document.getElementById('calcResultBox');
            const bonusBadge = document.getElementById('bonusBadge');
            
            // Base reward: $3 per invite
            const baseRewardPerInvite = 3;
            const baseReward = count * baseRewardPerInvite;
            
            // Bonus pada invite ke-2, ke-5, ke-8, dan ke-10
            let bonus = 0;
            if (count >= 2) bonus += 1; // Bonus invite ke-2
            if (count >= 5) bonus += 1; // Bonus invite ke-5
            if (count >= 8) bonus += 1; // Bonus invite ke-8
            if (count >= 10) bonus += 1; // Bonus invite ke-10
            
            // Total reward
            const totalReward = baseReward + bonus;
            
            // Konversi ke IDR (kurs: $1 = 16.000 IDR)
            const totalIdr = totalReward * 16000;
            
            requestAnimationFrame(() => {
                document.getElementById('totalUsd').innerText = `($${totalReward})`;
                document.getElementById('totalIdr').innerText = "Rp " + totalIdr.toLocaleString('id-ID');
                
                // Update badge bonus
                if (bonus > 0) {
                    bonusBadge.innerText = `Bonus: $${bonus}`;
                    bonusBadge.style.display = "inline-block";
                    box.classList.add('active');
                } else {
                    bonusBadge.style.display = "none";
                    box.classList.remove('active');
                }
            });
        }

        function sendToWa(e) {
            e.preventDefault();
            const email = document.getElementById('waEmail').value.trim();
            const code = document.getElementById('waCode').value.trim();
            if (isEmailDuplicate(email)) { 
                alert("Email ini sudah terdaftar sebagai VALID di sistem. Tidak perlu lapor lagi."); 
                return; 
            }
            const text = `*Berhasil undang*%0AEmail: ${email}%0AKode : ${code}`;
            window.open(`https://wa.me/6282329106594?text=${text}`, '_blank');
            closeModal('waModal'); 
            document.getElementById('waEmail').value = ""; 
            document.getElementById('waCode').value = "";
        }

        // Fungsi join request yang diubah (Email Utama, bukan WhatsApp)
        function sendJoinRequest(e) {
            e.preventDefault();
            const code = document.getElementById('reqCode').value;
            const email = document.getElementById('reqEmail').value; // Ganti dari phone ke email
            const target = document.getElementById('reqTarget').value;
            const text = `*Mendaftar Jadi Refferer*%0A%0ACode Saya: ${code}%0AEmail Utama : ${email}%0ATarget Invite: ${target}`;
            window.open(`https://wa.me/6282329106594?text=${text}`, '_blank');
            closeModal('joinModal');
        }

        async function fetchData() {
            if (isProcessing) return;
            isProcessing = true;
            
            try {
                const response = await fetch(BASE_URL, { 
                    method: 'GET', 
                    headers: { 'X-Master-Key': API_KEY },
                    cache: 'no-cache'
                });
                const result = await response.json();
                globalUsers = result.record.users || [];
                
                requestAnimationFrame(() => {
                    renderGroupedData(globalUsers); 
                    renderAdminList();
                });
            } catch (error) { 
                console.error(error); 
                groupContainer.innerHTML = `<div style="text-align:center; color:red;">Gagal memuat data.</div>`;
            } finally {
                isProcessing = false;
            }
        }

        // Fungsi untuk menghitung reward dengan sistem baru
        function calculateTotalReward(count) {
            const baseRewardPerInvite = 3;
            const baseReward = count * baseRewardPerInvite;
            
            // Bonus pada invite ke-2, ke-5, ke-8, dan ke-10
            let bonus = 0;
            if (count >= 2) bonus += 1;
            if (count >= 5) bonus += 1;
            if (count >= 8) bonus += 1;
            if (count >= 10) bonus += 1;
            
            return {
                base: baseReward,
                bonus: bonus,
                total: baseReward + bonus
            };
        }

        function renderGroupedData(users) {
            if (!groupContainer) return;
            
            groupContainer.innerHTML = '';
            if (users.length === 0) { 
                groupContainer.innerHTML = `<div style="text-align:center; color:#999;">Belum ada data.</div>`; 
                return; 
            }

            const groups = {};
            users.forEach(user => {
                const code = user.referral_code.toUpperCase().trim(); 
                if (!groups[code]) groups[code] = [];
                groups[code].push(user.email);
            });

            // Sorting Descending
            const sortedCodes = Object.keys(groups).sort((a, b) => groups[b].length - groups[a].length);

            sortedCodes.forEach((code, index) => {
                const emails = groups[code];
                const count = emails.length;
                
                // Hitung reward dengan sistem baru
                const reward = calculateTotalReward(count);
                const hasBonus = reward.bonus > 0;
                const badgeClass = hasBonus ? 'reward-badge high-tier' : 'reward-badge';

                const card = document.createElement('div');
                card.className = 'referral-card';
                card.style.animationDelay = `${index * 0.1}s`;

                let emailListHTML = '';
                emails.forEach(email => { 
                    emailListHTML += `<li class="email-item">${email}</li>`; 
                });

                // Tampilkan bonus jika ada
                const bonusText = hasBonus ? `<div style="font-size:0.7rem; color:#8b5cf6; margin-top:2px;">+ $${reward.bonus} bonus</div>` : '';

                card.innerHTML = `
                    <div class="card-header">
                        <span class="code-title">${code}</span>
                        <div>
                            <span class="${badgeClass}">Total: $${reward.total}</span>
                            ${bonusText}
                        </div>
                    </div>
                    <div class="card-stats">
                        <span class="stat-item">Invite : <strong>${count} Email</strong></span>
                        <span class="stat-item">Rate : <strong>$3 (48.000)</strong></span>
                    </div>
                    <ul class="email-list">${emailListHTML}</ul>
                `;
                groupContainer.appendChild(card);
            });
            filterReferral();
        }

        function renderAdminList() {
            if (!adminDataList) return;
            
            adminDataList.innerHTML = '';
            if (globalUsers.length === 0) { 
                adminDataList.innerHTML = `<div style="text-align:center; color:#999; padding:20px;">Belum ada data.</div>`; 
                return; 
            }
            
            const fragment = document.createDocumentFragment();
            
            globalUsers.map((user, index) => ({ user, index })).reverse().forEach((item, i) => {
                const div = document.createElement('div');
                div.className = 'admin-item';
                div.style.animationDelay = `${i * 0.05}s`;
                div.innerHTML = `
                    <div class="admin-info"><strong>${item.user.email}</strong><span>Kode: ${item.user.referral_code}</span></div>
                    <div class="admin-actions">
                        <button class="btn-edit" onclick="startEdit(${item.index})">Edit</button>
                        <button class="btn-delete" onclick="deleteUser(${item.index})">Hapus</button>
                    </div>`;
                fragment.appendChild(div);
            });
            
            adminDataList.appendChild(fragment);
        }

        function startEdit(index) {
            const user = globalUsers[index]; 
            inputCode.value = user.referral_code; 
            inputEmail.value = user.email; 
            editIndexInput.value = index;
            formTitle.innerText = "Edit Data"; 
            submitBtn.innerText = "Update"; 
            submitBtn.style.background = "var(--warning-orange)"; 
            cancelBtn.classList.remove('hidden'); 
            
            requestAnimationFrame(() => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }

        function resetForm() {
            addForm.reset(); 
            editIndexInput.value = "-1"; 
            formTitle.innerText = "Tambah Data Baru"; 
            submitBtn.innerText = "Simpan"; 
            submitBtn.style.background = "var(--linkedin-blue)"; 
            cancelBtn.classList.add('hidden');
        }

        async function deleteUser(index) { 
            if(!confirm("Yakin ingin menghapus?")) return; 
            globalUsers.splice(index, 1); 
            await saveToCloud(); 
        }

        async function deleteAllData() {
            if (globalUsers.length === 0) return alert("Data sudah kosong.");
            if (!confirm("⚠️ PERINGATAN ⚠️\n\nApakah Anda yakin ingin MENGHAPUS SEMUA DATA?")) return;
            const verify = prompt("Ketik 'HAPUS' untuk mengonfirmasi:");
            if (verify !== "HAPUS") return alert("Penghapusan dibatalkan.");
            globalUsers = []; 
            await saveToCloud(); 
            alert("Semua data berhasil dihapus.");
        }

        addForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            if (isProcessing) return;
            
            const code = inputCode.value.trim(); 
            const email = inputEmail.value.trim(); 
            const editIndex = parseInt(editIndexInput.value);
            
            if (isEmailDuplicate(email, editIndex)) { 
                alert("Gagal: Email ini sudah terdaftar!"); 
                return; 
            }
            
            submitBtn.innerText = "Memproses..."; 
            submitBtn.disabled = true;
            isProcessing = true;
            
            try {
                if (editIndex === -1) { 
                    globalUsers.push({ email, referral_code: code }); 
                } else { 
                    globalUsers[editIndex] = { email, referral_code: code }; 
                }
                await saveToCloud(); 
                resetForm();
            } catch (err) { 
                alert("Gagal: " + err.message); 
                submitBtn.innerText = (editIndex === -1) ? "Simpan" : "Update"; 
                submitBtn.disabled = false; 
            } finally {
                isProcessing = false;
            }
        });

        async function saveToCloud() {
            renderAdminList();
            
            try {
                await fetch(BASE_URL, { 
                    method: 'PUT', 
                    headers: { 
                        'Content-Type': 'application/json', 
                        'X-Master-Key': API_KEY 
                    }, 
                    body: JSON.stringify({ users: globalUsers }) 
                });
                
                submitBtn.innerText = "Simpan"; 
                submitBtn.style.background = "var(--linkedin-blue)"; 
                submitBtn.disabled = false; 
                alert("Data berhasil disimpan!");
                
                // Update dashboard view
                renderGroupedData(globalUsers);
            } catch (error) {
                alert("Gagal menyimpan data: " + error.message);
                submitBtn.disabled = false;
            }
        }

        // ============================================
        // FITUR EMAIL MASSA
        // ============================================

        function processMassEmail(e) {
            e.preventDefault();
            
            const code = document.getElementById('massCode').value.trim();
            const emailsInput = document.getElementById('massEmails').value.trim();
            
            if (!code) {
                alert("Harap masukkan kode referral!");
                return;
            }
            
            if (!emailsInput) {
                alert("Harap masukkan daftar email!");
                return;
            }
            
            // Simpan kode untuk digunakan nanti
            massEmailData.code = code;
            
            // Parse email dari input (support koma, spasi, baris baru)
            const emailPattern = /[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g;
            const extractedEmails = emailsInput.match(emailPattern) || [];
            
            if (extractedEmails.length === 0) {
                alert("Tidak ditemukan format email yang valid!");
                return;
            }
            
            // Normalize emails (lowercase, trim)
            const normalizedEmails = extractedEmails.map(email => email.toLowerCase().trim());
            
            // Hapus duplikat dalam input
            const uniqueEmails = [...new Set(normalizedEmails)];
            
            // Identifikasi email yang sudah ada di database
            processedEmails = uniqueEmails.map(email => {
                const isDuplicate = isEmailDuplicate(email);
                return {
                    email: email,
                    isDuplicate: isDuplicate,
                    status: isDuplicate ? 'duplicate' : 'new'
                };
            });
            
            // Tampilkan hasil
            displayProcessedEmails();
        }
        
        function displayProcessedEmails() {
            const previewContainer = document.getElementById('emailPreview');
            const resultsContainer = document.getElementById('massResults');
            const totalEmailsEl = document.getElementById('totalEmails');
            const newEmailsEl = document.getElementById('newEmails');
            const duplicateEmailsEl = document.getElementById('duplicateEmails');
            
            // Hitung statistik
            const total = processedEmails.length;
            const newCount = processedEmails.filter(e => !e.isDuplicate).length;
            const duplicateCount = processedEmails.filter(e => e.isDuplicate).length;
            
            // Update statistik
            totalEmailsEl.textContent = total;
            newEmailsEl.textContent = newCount;
            duplicateEmailsEl.textContent = duplicateCount;
            
            // Tampilkan email dalam preview
            previewContainer.innerHTML = '';
            
            if (processedEmails.length === 0) {
                previewContainer.innerHTML = '<p style="text-align: center; color: #999;">Tidak ada email untuk ditampilkan</p>';
            } else {
                const fragment = document.createDocumentFragment();
                
                processedEmails.forEach((emailData, index) => {
                    const emailItem = document.createElement('div');
                    emailItem.className = `email-preview-item ${emailData.status}`;
                    
                    const badgeText = emailData.isDuplicate ? 'DUPLIKAT' : 'BARU';
                    const badgeClass = emailData.isDuplicate ? 'badge-duplicate' : 'badge-new';
                    
                    emailItem.innerHTML = `
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span>${emailData.email}</span>
                            <span class="email-preview-badge ${badgeClass}">${badgeText}</span>
                        </div>
                        <div class="email-preview-actions">
                            <button type="button" class="btn-remove-email" onclick="removeProcessedEmail(${index})" title="Hapus email">
                                ×
                            </button>
                        </div>
                    `;
                    
                    fragment.appendChild(emailItem);
                });
                
                previewContainer.appendChild(fragment);
            }
            
            // Tampilkan container hasil
            resultsContainer.style.display = 'block';
            
            // Scroll ke hasil
            requestAnimationFrame(() => {
                resultsContainer.scrollIntoView({ behavior: 'smooth' });
            });
        }
        
        function removeProcessedEmail(index) {
            if (confirm(`Hapus email ${processedEmails[index].email} dari list?`)) {
                processedEmails.splice(index, 1);
                displayProcessedEmails();
            }
        }
        
        function removeAllProcessedEmails() {
            if (processedEmails.length === 0) return;
            
            if (confirm(`Hapus semua ${processedEmails.length} email dari list?`)) {
                processedEmails = [];
                displayProcessedEmails();
            }
        }
        
        async function saveMassEmails() {
            if (processedEmails.length === 0) {
                alert("Tidak ada email untuk disimpan!");
                return;
            }
            
            // Filter hanya email baru (non-duplikat)
            const newEmails = processedEmails.filter(e => !e.isDuplicate);
            
            if (newEmails.length === 0) {
                alert("Semua email sudah ada di database. Tidak ada yang perlu disimpan.");
                return;
            }
            
            // Konfirmasi penyimpanan
            const confirmSave = confirm(`Simpan ${newEmails.length} email baru dengan kode "${massEmailData.code}"?`);
            if (!confirmSave) return;
            
            // Tambahkan email baru ke globalUsers
            newEmails.forEach(emailData => {
                globalUsers.push({
                    email: emailData.email,
                    referral_code: massEmailData.code
                });
            });
            
            // Simpan ke cloud
            const saveBtn = document.getElementById('saveMassBtn');
            saveBtn.textContent = "Menyimpan...";
            saveBtn.disabled = true;
            
            try {
                await saveToCloud();
                
                // Reset form dan tampilkan hasil
                alert(`Berhasil menyimpan ${newEmails.length} email baru!`);
                resetMassForm();
                closeModal('massModal');
            } catch (err) {
                alert("Gagal menyimpan email: " + err.message);
                saveBtn.textContent = "Simpan Email Baru";
                saveBtn.disabled = false;
            }
        }
        
        function resetMassForm() {
            document.getElementById('massForm').reset();
            document.getElementById('massResults').style.display = 'none';
            processedEmails = [];
            massEmailData = {};
        }

        // Initialize dengan animasi smooth
        document.addEventListener('DOMContentLoaded', () => {
            // Animasi loading halus
            setTimeout(() => {
                fetchData();
            }, 300);
            
            // Smooth scroll untuk semua anchor link
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    if (targetId === '#') return;
                    
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        window.scrollTo({
                            top: targetElement.offsetTop - 20,
                            behavior: 'smooth'
                        });
                    }
                });
            });
            
            // Preload efek
            document.body.style.opacity = '0';
            document.body.style.transition = 'opacity 0.5s ease';
            
            requestAnimationFrame(() => {
                document.body.style.opacity = '1';
            });
        });

        // Performance optimization for scroll dengan requestAnimationFrame
        let ticking = false;
        window.addEventListener('scroll', () => {
            if (!ticking) {
                requestAnimationFrame(() => {
                    // Handle scroll-related animations here if needed
                    ticking = false;
                });
                ticking = true;
            }
        }, { passive: true });

        // Smooth hover efek untuk semua card
        document.addEventListener('mousemove', (e) => {
            const cards = document.querySelectorAll('.referral-card');
            cards.forEach(card => {
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                // Efek subtle glow berdasarkan posisi mouse
                card.style.setProperty('--mouse-x', `${x}px`);
                card.style.setProperty('--mouse-y', `${y}px`);
            });
        });

    </script>
</body>
</html>